<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Target Decoy FDR • prozor</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Target Decoy FDR">
<meta property="og:description" content="prozor">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prozor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cdsw.html">Computing Dynamic SWATH Windows</a>
    </li>
    <li>
      <a href="../articles/CreatingDecoyDB.html">Creating Target Decoy Databases</a>
    </li>
    <li>
      <a href="../articles/PeptideAnnotationwithProzor.html">Peptide Annotation and Protein Inference</a>
    </li>
    <li>
      <a href="../articles/TargetDecoyFDR_Example.html">Target Decoy FDR</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/protviz/prozor/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Target Decoy FDR</h1>
                        <h4 class="author">Witold Wolski</h4>
            
            <h4 class="date">2021-12-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/protviz/prozor/blob/master/../vignettes/TargetDecoyFDR_Example.Rmd"><code>../vignettes/TargetDecoyFDR_Example.Rmd</code></a></small>
      <div class="hidden name"><code>TargetDecoyFDR_Example.Rmd</code></div>

    </div>

    
    
<p>Here we describe how you can estimate the false discovery rate (FDR) when matching your spectra against a FASTA sequence database using spectra search engines such as Mascot or Comet. The sequence database contains forward sequences and the same number of reverse sequences.</p>
<div id="the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#the-data" class="anchor"></a>The data</h2>
<p>The data needs to have two columns, one with a label, to distinguish targets and decoys, the other with a score. Then you also need to know if a larger score or a smaller score is better. In our example data, we have two scores: <code>score</code> and <code>score2</code>. While the <code>score</code> is better if it smaller (e.g, posterior erro probability), <code>score2</code> is better if it is larger.</p>
<div class="figure">
<img src="TargetDecoyFDR_Example_files/figure-html/targetdecoy-1.png" alt="Black line - Score distribution of decoy hits. Green line - Score distribution of vorward hits. TN - true netagive, FN - false negative, FP - false postitive, TP - true positive" width="700"><p class="caption">
Black line - Score distribution of decoy hits. Green line - Score distribution of vorward hits. TN - true netagive, FN - false negative, FP - false postitive, TP - true positive
</p>
</div>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/protviz/prozor">prozor</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">fdrSample</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">fdrSample</span>, <span class="va">score2</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fdrSample</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">proteinID</th>
<th align="right">score</th>
<th align="right">score2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">28064</td>
<td align="left">sp|P00738|HPT_HUMAN</td>
<td align="right">0.0030141</td>
<td align="right">2.520847</td>
</tr>
<tr class="even">
<td align="left">47194</td>
<td align="left">sp|P19823|ITIH2_HUMAN</td>
<td align="right">0.0008878</td>
<td align="right">3.051662</td>
</tr>
<tr class="odd">
<td align="left">8916</td>
<td align="left">sp|Q86WI1|PKHL1_HUMAN</td>
<td align="right">0.0350109</td>
<td align="right">1.455797</td>
</tr>
<tr class="even">
<td align="left">37157</td>
<td align="left">sp|P04003|C4BPA_HUMAN</td>
<td align="right">0.0018141</td>
<td align="right">2.741330</td>
</tr>
<tr class="odd">
<td align="left">60963</td>
<td align="left">sp|P01876|IGHA1_HUMAN</td>
<td align="right">0.0000013</td>
<td align="right">5.897889</td>
</tr>
<tr class="even">
<td align="left">89689</td>
<td align="left">sp|P01042|KNG1_HUMAN</td>
<td align="right">0.0000000</td>
<td align="right">12.305967</td>
</tr>
</tbody>
</table>
<p>What is also required is that the number of Targets and Decoys are the same. This is given for mass spectrometry database searches. Our dataset here is already truncated at a 5% FDR. Therefore the number of decoys is much smaller.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"REV_"</span>,<span class="va">fdrSample</span><span class="op">$</span><span class="va">proteinID</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
## 39142   858</code></pre>
<p>In our example, we will use the package to filter the data further for a 1% FDR.</p>
<p>Computing the FDR can be done by calling the function <code>computeFDR</code>. <code>plotFDR</code> than shows the score distribution for the targets (black) and decoys (red) as well as the FDR for the two scores implemented (x axis).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fdr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeFDR.html">computeFDR</a></span><span class="op">(</span><span class="va">fdrSample</span><span class="op">$</span><span class="va">score</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"REV_"</span>,<span class="va">fdrSample</span><span class="op">$</span><span class="va">proteinID</span><span class="op">)</span>,larger_better <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotFDR.html">plotFDR</a></span><span class="op">(</span><span class="va">fdr1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FPR"</span>, <span class="st">"qValue/FDR"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="TargetDecoyFDR_Example_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>The output is a named list which can be easily converted into a data frame. We next will briefly discuss the elements of the output.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">fdr1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">larger_better</th>
<th align="right">order</th>
<th align="left">decoy_hit</th>
<th align="right">score</th>
<th align="right">FPR</th>
<th align="right">SimpleFDR</th>
<th align="right">qValue_FPR</th>
<th align="right">qValue_SimpleFDR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">FALSE</td>
<td align="right">287</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="right">3581</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">FALSE</td>
<td align="right">29584</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="right">26559</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">FALSE</td>
<td align="right">15524</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="right">30840</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="types-of-fdr" class="section level2">
<h2 class="hasAnchor">
<a href="#types-of-fdr" class="anchor"></a>Types of FDR</h2>
<p>We define</p>
<pre><code> * false postivies (FP) as the number of passing decoy assignments
 * true positives (TP) as the number of passing forward hits.</code></pre>
<div id="false-postive-rate" class="section level3">
<h3 class="hasAnchor">
<a href="#false-postive-rate" class="anchor"></a>False postive rate</h3>
<p>Which is the “Fraction of incorrect assignments above score threshold”. The multiplier 2 is needed here since we assume that also the forward sequences have false assignments.</p>
<p><span class="math display">\[
FPR = \frac{2 \cdot FP}{TP + FP}
\]</span></p>
<p>This is taken from the reference by <span class="citation">(Elias and Gygi 2007)</span>. <span class="citation">(Storey and Tibshirani 2003)</span> defines FPR differently. Kaell points out that the FPR here actually should be named FDR and that “Many proteomics papers incorrectly refer to this quantity as the <em>false positive rate</em>.”</p>
</div>
<div id="simple-fdr" class="section level3">
<h3 class="hasAnchor">
<a href="#simple-fdr" class="anchor"></a>Simple FDR</h3>
<p>“The FDR associated with a particular score threshold is defined as the expected percentage of accepted PSMs that are incorrect, where an <em>accepted PSM</em> is one that scores above the threshold (Many proteomics papers incorrectly refer to this quantity as the <em>false positive rate</em>).” (<span class="citation">(Käll et al. 2007)</span>)</p>
<p>The Simple FDR intrudced by (<span class="citation">(Käll et al. 2007)</span>) is defined by :</p>
<p><span class="math display">\[
SimpleFDR =  \frac{FP}{TP}
\]</span></p>
<p>“For a given score threshold, we count the number of decoy PSMs above the threshold and the number of target PSMs above the threshold. We can now estimate the FDR by simply computing the ratio of these two values (SimpleFDR).”<span class="citation">(Käll et al. 2007)</span></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fdr1</span><span class="op">$</span><span class="va">score</span>, <span class="va">fdr1</span><span class="op">$</span><span class="va">SimpleFDR</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.002</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.0005</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">fdr1</span><span class="op">$</span><span class="va">score</span>, <span class="va">fdr1</span><span class="op">$</span><span class="va">qValue_SimpleFDR</span>, col <span class="op">=</span> <span class="fl">3</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.002</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.002</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FDR"</span>, <span class="st">"qValue"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="TargetDecoyFDR_Example_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>Although the score is getting better (smaller) the FDR may increase since the number of TP in the denominator decreases while the number of FP stays the same. Therefore Storey and Tibshirani proposed the <em>q-value</em>, “which in our case is defined as the minimal FDR threshold at which a given PSM is accepted”<span class="citation">(Käll et al. 2007)</span>.</p>
</div>
</div>
<div id="getting-the-score-for-an-fdr-" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-the-score-for-an-fdr-" class="anchor"></a>Getting the score for an FDR.</h2>
<p>Most frequently you will need to get the score for an FDR in order to filter your data. To report your data with an FDR of 1% instead of 5% you can execute this code:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">score01G</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictScoreFDR.html">predictScoreFDR</a></span><span class="op">(</span><span class="va">fdr1</span>,qValue <span class="op">=</span> <span class="fl">5</span>,method <span class="op">=</span> <span class="st">"FPR"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.09991592</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">fdrSample</span>, <span class="va">score</span> <span class="op">&lt;</span> <span class="va">score01G</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 39999     3</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">score01G</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictScoreFDR.html">predictScoreFDR</a></span><span class="op">(</span><span class="va">fdr1</span>,qValue <span class="op">=</span> <span class="fl">1</span>,method <span class="op">=</span> <span class="st">"FPR"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.008509834</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">fdrSample</span>, <span class="va">score</span> <span class="op">&lt;</span> <span class="va">score01G</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 29179     3</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">score01K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictScoreFDR.html">predictScoreFDR</a></span><span class="op">(</span><span class="va">fdr1</span>,qValue <span class="op">=</span> <span class="fl">1</span>,method <span class="op">=</span> <span class="st">"SimpleFDR"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.03394749</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">fdrSample</span>, <span class="va">score</span> <span class="op">&lt;</span> <span class="va">score01K</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 34875     3</code></pre>
</div>
<div id="the-order-column" class="section level2">
<h2 class="hasAnchor">
<a href="#the-order-column" class="anchor"></a>The order column</h2>
<p>Since the scores are sorted to compute the FDR, we return also the <em>order</em> column. This column can be used to align the ID’s with the scores.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="va">fdrSample</span><span class="op">$</span><span class="va">proteinID</span><span class="op">[</span><span class="va">fdr1</span><span class="op">$</span><span class="va">order</span><span class="op">]</span>, <span class="va">fdr1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">ID</th>
<th align="left">larger_better</th>
<th align="right">order</th>
<th align="left">decoy_hit</th>
<th align="right">score</th>
<th align="right">FPR</th>
<th align="right">SimpleFDR</th>
<th align="right">qValue_FPR</th>
<th align="right">qValue_SimpleFDR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">sp|P04264|K2C1_HUMAN</td>
<td align="left">FALSE</td>
<td align="right">287</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">sp|P04264|K2C1_HUMAN</td>
<td align="left">FALSE</td>
<td align="right">3581</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">sp|P35527|K1C9_HUMAN</td>
<td align="left">FALSE</td>
<td align="right">29584</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">sp|P04264|K2C1_HUMAN</td>
<td align="left">FALSE</td>
<td align="right">26559</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">sp|P02768|ALBU_HUMAN</td>
<td align="left">FALSE</td>
<td align="right">15524</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">sp|P04264|K2C1_HUMAN</td>
<td align="left">FALSE</td>
<td align="right">30840</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>For convenience we provide the function <code>computeFDRwithID</code> which integrates the reordering of the ID’s.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fdr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeFDRwithID.html">computeFDRwithID</a></span><span class="op">(</span><span class="va">fdrSample</span><span class="op">$</span><span class="va">score</span>,<span class="va">fdrSample</span><span class="op">$</span><span class="va">proteinID</span>, decoy <span class="op">=</span> <span class="st">"REV_"</span>,larger_better <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">fdr1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">larger_better</th>
<th align="right">order</th>
<th align="left">decoy_hit</th>
<th align="right">score</th>
<th align="right">FPR</th>
<th align="right">SimpleFDR</th>
<th align="right">qValue_FPR</th>
<th align="right">qValue_SimpleFDR</th>
<th align="left">ID</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">FALSE</td>
<td align="right">287</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">sp|P04264|K2C1_HUMAN</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="right">3581</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">sp|P04264|K2C1_HUMAN</td>
</tr>
<tr class="odd">
<td align="left">FALSE</td>
<td align="right">29584</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">sp|P35527|K1C9_HUMAN</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="right">26559</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">sp|P04264|K2C1_HUMAN</td>
</tr>
<tr class="odd">
<td align="left">FALSE</td>
<td align="right">15524</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">sp|P02768|ALBU_HUMAN</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="right">30840</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">sp|P04264|K2C1_HUMAN</td>
</tr>
</tbody>
</table>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.1.1 (2021-08-10)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 19044)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United States.1252 
## [2] LC_CTYPE=English_United States.1252   
## [3] LC_MONETARY=English_United States.1252
## [4] LC_NUMERIC=C                          
## [5] LC_TIME=English_United States.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] prozor_0.3.1 dplyr_1.0.7 
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.7            bslib_0.3.1           compiler_4.1.1       
##  [4] pillar_1.6.4          jquerylib_0.1.4       highr_0.9            
##  [7] tools_4.1.1           docopt_0.7.1          digest_0.6.28        
## [10] lattice_0.20-44       AhoCorasickTrie_0.1.2 jsonlite_1.7.2       
## [13] evaluate_0.14         memoise_2.0.0         lifecycle_1.0.1      
## [16] tibble_3.1.4          pkgconfig_2.0.3       rlang_0.4.11         
## [19] Matrix_1.3-4          DBI_1.1.1             yaml_2.2.1           
## [22] pkgdown_1.6.1         xfun_0.26             fastmap_1.1.0        
## [25] stringr_1.4.0         knitr_1.36            hms_1.1.1            
## [28] desc_1.4.0            generics_0.1.1        fs_1.5.0             
## [31] sass_0.4.0            vctrs_0.3.8           systemfonts_1.0.3    
## [34] ade4_1.7-18           grid_4.1.1            rprojroot_2.0.2      
## [37] tidyselect_1.1.1      glue_1.4.2            R6_2.5.1             
## [40] textshaping_0.3.6     fansi_0.5.0           rmarkdown_2.11       
## [43] tzdb_0.1.2            readr_2.0.1           seqinr_4.2-8         
## [46] purrr_0.3.4           magrittr_2.0.1        MASS_7.3-54          
## [49] htmltools_0.5.2       ellipsis_0.3.2        assertthat_0.2.1     
## [52] ragg_1.2.0            utf8_1.2.2            stringi_1.7.4        
## [55] cachem_1.0.6          crayon_1.4.2</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Elias2007">
<p>Elias, Joshua E, and Steven P Gygi. 2007. “Target-Decoy Search Strategy for Increased Confidence in Large-Scale Protein Identifications by Mass Spectrometry.” <em>Nature Methods</em> 4 (3): 207–14.</p>
</div>
<div id="ref-Kaell2007">
<p>Käll, Lukas, John D Storey, Michael J MacCoss, and William Stafford Noble. 2007. “Assigning Significance to Peptides Identified by Tandem Mass Spectrometry Using Decoy Databases.” <em>Journal of Proteome Research</em> 7 (01): 29–34.</p>
</div>
<div id="ref-Storey2003">
<p>Storey, John D, and Robert Tibshirani. 2003. “Statistical Significance for Genomewide Studies.” <em>Proceedings of the National Academy of Sciences</em> 100 (16): 9440–5.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Witold Wolski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
